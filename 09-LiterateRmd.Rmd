---
title: "LiterateRmd"
author: "Kevin Lanning"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---
# (PART) Part III Towards data proficiency  {-}

## status 80% {-}

Move data challenges from extra credit project to a project due before Spring break. 

Include additional summaries from the four r4ds chapters. 

---

In this part of the class we will get into the nuts and bolts of R.

# literate programming with R markdown

Showing your work, to (future) you as well as others, is a key part of reproducible science.  R Markdown documents facilitate this, as they allow you to include comments, code, and results in a single place.  But before we consider R markdown, we begin with two more elemental ideas: *scripts* (R4DS, Chapter 6) and *projects* (Chapter 8). 

## scripts are files of code

We begin with R4DS Chapter 6, which shows the R studio interface and encourages you to save your work using scripts, written in the source (editor) window in the upper left quadrant of the default R studio screen. 

Note the recommendations - for example, include packages (libraries) at the beginning of your code. One more thing - in setting up R studio, consider adjusting the "insert spaces for tab" setting to something more than 2. This will allow you to more easily see the nested structure of functions, loops, etc. - and will create a modest disincentive against making these nested structures too deep or complex:

![Fig 9.1: I use 4 spaces here. YMMV.](C:\Users\lanning\Dropbox\0DataSciLibArts\RStudioOptions.jpg)

Note, too, the [code diagnostics](https://support.rstudio.com/hc/en-us/articles/205753617-Code-Diagnostics) in R. Consider enabling all of these, including the R style diagnostics, to help you keep your code readable:

  ![Fig 9.2: Enable code diagnostics](C:\Users\lanning\Dropbox\0DataSciLibArts\codediagnostics.PNG)

## projects are directories containing related scripts

You will save your work in *projects* - which isolate your data and scripts into different directories. (See r4ds, Chapter 8). To reinforce the idea that your unit of analysis in R is "the project" rather than "the script", consider associating your Rmd filetype (see next section) with your markdown editor, and only your Rproj filetype with R studio.  

Soon, it is likely that you will soon be working on R for different things in parallel - for this and another class, for this class and your thesis, or perhaps for two distinct types of analysis within your thesis.  When you open up an R project, you'll be in the right directory, with the relevant files (and only the relevant files) at your fingertips in the files pane. 

## R markdown documents integrate rationale, script, and results

R Markdown documents allow you to include comments, scripts, and results in a single place.  The basics of R markdown are presented in Chapter 27 of R4DS.  I encourage you to use R markdown for nearly everything you do in R. 

Within R studio, open up a new R markdown document. There are as many as four parts of an R markdown document:

-   A YAML (yet another markdown language) header
-   Text formatted in markdown
-   R code (chunks) surrounded by code fences
-   and, occasionally, inline code

There is a handy [R Markdown cheat sheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf) which can give you a sense of what R markdown is about. It describes eight steps, from "workflow" to "publish" (and a ninth, "learn more").  Don't worry about all of the detail here, but do get a sense of how it works.

> Exercise 9.1:
>
> Working in groups, do the exercises in section 27.4.7 of R4DS.
>
> Begin with the R markdown file that is included at the beginning of Chapter 27. You can download it [here](https://raw.githubusercontent.com/hadley/r4ds/master/rmarkdown/diamond-sizes.Rmd).
>
> Study the code, and annotate it so that you have a better sense of how it works. For example, "this  block loads needed libraries, then takes the _____dataset and ___________ ."
>
> Play with the graph. Change one or more parameters of it to make it more useful.  Again, annotate your changes.

## What to do when you are stuck

- google. pay attention to your error messages

- ask for help, make your questions clear and reproducible (see R4DS Chapter 1)

- take a break, think outside the box and [kludge](https://www.google.com/search?newwindow=1&safe=active&rlz=1C1SQJL_enUS782US782&q=Dictionary#dobs=kludge) something together if you have to

- document your struggle and your cleverness for a future you



## appendix: a few possible data challenges

As you will recall, you have the opportunity to gain extra credit in the class by successfully undertaking a data science challenge.  Here are a few possibilities:

Working with two of your classmates, write an R markdown document titled "**The most dangerous equation**?" which (a) in the introduction, discusses @wainer2007most, (b) then illustrates regression to the mean and (c) deMoivre's equation, ideally (d) using the examples of 'punishment' and 'sex differences in variability' discussed in class and the text, respectively. Prepare a presentation using Rpres which summarizes your argument and findings. 

Working with two or three of your classmates, write an R markdown document titled "**On the rationality of poker**." In it, you will (a) derive the probability of receiving various hands (e.g., 4 of a kind) using probability theory, (b) assess these same probabilities empirically on the basis of a Monte Carlo analysis, and (c) compare these probabilities to the order of winning hands (e.g., 4 of a kind beats a full house). Prepare a presentation using Rpres which summarizes your argument and findings. 

Working with two or three of your classmates, consider **what are the most important lessons from the reproducibility crisis?**  Is, for example "transparency" (showing every part of your work) more important than "preregistration" (publicly declaring your plan of analysis in advance)? Can Null Hypothesis Significance Testing (NHST) be saved, and, if so, what is the solution?  This paper will be more scholarly than the others, but you should include code (for example, write an R markdown document which demonstrates how "p-hacking" might lead to a spurious result in a test of an initially vague hypothesis).  Again, prepare a presentation using Rpres which summarizes your argument and findings. 

Now back to the elements of your R workflow.