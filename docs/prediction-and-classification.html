<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>19 prediction and classification | Data science for the liberal arts</title>
  <meta name="description" content="19 prediction and classification | Data science for the liberal arts" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="19 prediction and classification | Data science for the liberal arts" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="kevinlanning/DSLA25" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 prediction and classification | Data science for the liberal arts" />
  
  
  

<meta name="author" content="Kevin Lanning" />


<meta name="date" content="2025-04-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cross-validation.html"/>
<link rel="next" href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#the-role-of-the-liberal-arts-in-data-science"><i class="fa fa-check"></i>the role of the liberal arts in data science</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#some-features-of-the-text"><i class="fa fa-check"></i>some features of the text</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#the-book-is-for-you"><i class="fa fa-check"></i>the book is for you</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-introduction.html"><a href="part-i-introduction.html"><i class="fa fa-check"></i>PART I: Introduction</a></li>
<li class="chapter" data-level="1" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html"><i class="fa fa-check"></i><b>1</b> what is “data science for the liberal arts?”</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#the-incompleteness-of-the-data-science-venn-diagram"><i class="fa fa-check"></i><b>1.1</b> the incompleteness of the data science Venn diagram</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#additional-domains"><i class="fa fa-check"></i><b>1.1.1</b> additional domains</a></li>
<li class="chapter" data-level="1.1.2" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#an-additional-dimension"><i class="fa fa-check"></i><b>1.1.2</b> an additional dimension</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#the-importance-of-data-science-for-society"><i class="fa fa-check"></i><b>1.2</b> the importance of data science for society</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#training-in-the-liberal-arts---success-in-tech"><i class="fa fa-check"></i><b>1.2.1</b> training in the liberal arts -&gt; success in tech</a></li>
<li class="chapter" data-level="1.2.2" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#the-challenge-of-tmi"><i class="fa fa-check"></i><b>1.2.2</b> the challenge of TMI</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="what-is-data-science-for-the-liberal-arts.html"><a href="what-is-data-science-for-the-liberal-arts.html#discussion-what-are-your-objectives-in-data-science"><i class="fa fa-check"></i><b>1.3</b> discussion: what are your objectives in data science?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> getting started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#are-you-already-a-programmer-and-statistician"><i class="fa fa-check"></i><b>2.1</b> are you already a programmer and statistician?</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#spreadsheets---some-best-practices"><i class="fa fa-check"></i><b>2.2</b> spreadsheets - some best practices</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#setting-up-your-machine-some-basic-tools"><i class="fa fa-check"></i><b>2.3</b> setting up your machine: some basic tools</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#a-modified-15-minute-rule"><i class="fa fa-check"></i><b>2.4</b> a (modified) 15-minute rule</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#installing-r-and-rstudio-desktop"><i class="fa fa-check"></i><b>2.5</b> installing R and RStudio desktop</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html"><i class="fa fa-check"></i><b>3</b> what R stands for …</a>
<ul>
<li class="chapter" data-level="3.1" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#some-key-characteristics-of-r"><i class="fa fa-check"></i><b>3.1</b> some key characteristics of R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#base-r-and-packages"><i class="fa fa-check"></i><b>3.1.1</b> base R and packages</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#cha-cha-cha-changes"><i class="fa fa-check"></i><b>3.2</b> cha-cha-cha-changes</a></li>
<li class="chapter" data-level="3.3" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#some-technical-characteristics"><i class="fa fa-check"></i><b>3.3</b> some technical characteristics</a></li>
<li class="chapter" data-level="3.4" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#finding-help"><i class="fa fa-check"></i><b>3.4</b> finding help</a></li>
<li class="chapter" data-level="3.5" data-path="what-r-stands-for.html"><a href="what-r-stands-for.html#wickham-and-r-for-data-science-2e"><i class="fa fa-check"></i><b>3.5</b> Wickham and R for Data Science 2e</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploring-r-world.html"><a href="exploring-r-world.html"><i class="fa fa-check"></i><b>4</b> exploring R world</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploring-r-world.html"><a href="exploring-r-world.html#go-to-the-movies"><i class="fa fa-check"></i><b>4.1</b> go to the movies</a></li>
<li class="chapter" data-level="4.2" data-path="exploring-r-world.html"><a href="exploring-r-world.html#go-into-the-clouds"><i class="fa fa-check"></i><b>4.2</b> go into the clouds</a></li>
<li class="chapter" data-level="4.3" data-path="exploring-r-world.html"><a href="exploring-r-world.html#open-the-box"><i class="fa fa-check"></i><b>4.3</b> open the box</a></li>
<li class="chapter" data-level="4.4" data-path="exploring-r-world.html"><a href="exploring-r-world.html#go-to-datacamp"><i class="fa fa-check"></i><b>4.4</b> go to (data)camp</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-r-world.html"><a href="exploring-r-world.html#learn-to-knit"><i class="fa fa-check"></i><b>4.5</b> learn to knit</a></li>
<li class="chapter" data-level="4.6" data-path="exploring-r-world.html"><a href="exploring-r-world.html#older-approaches"><i class="fa fa-check"></i><b>4.6</b> older approaches</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="exploring-r-world.html"><a href="exploring-r-world.html#using-swirl"><i class="fa fa-check"></i><b>4.6.1</b> <strong>using Swirl</strong></a></li>
<li class="chapter" data-level="4.6.2" data-path="exploring-r-world.html"><a href="exploring-r-world.html#readingwatching-roger-pengs-text-andor-videos"><i class="fa fa-check"></i><b>4.6.2</b> reading/watching Roger Peng’s text and/or videos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-towards-data-literacy.html"><a href="part-ii-towards-data-literacy.html"><i class="fa fa-check"></i>Part II: Towards data literacy</a></li>
<li class="chapter" data-level="5" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html"><i class="fa fa-check"></i><b>5</b> now draw the rest of the owl</a>
<ul>
<li class="chapter" data-level="5.1" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html#time-for-hands-on-experience"><i class="fa fa-check"></i><b>5.1</b> time for hands-on experience</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html#consider-loading-the-tidyverse"><i class="fa fa-check"></i><b>5.1.1</b> consider loading the tidyverse</a></li>
<li class="chapter" data-level="5.1.2" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html#now-explore-the-babynames-package"><i class="fa fa-check"></i><b>5.1.2</b> now explore the babynames package</a></li>
<li class="chapter" data-level="5.1.3" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html#or-the-ggplot2movies-package"><i class="fa fa-check"></i><b>5.1.3</b> or the (ggplot2)movies package</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="now-draw-the-rest-of-the-owl.html"><a href="now-draw-the-rest-of-the-owl.html#assignment"><i class="fa fa-check"></i><b>5.2</b> assignment</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="literate-programming.html"><a href="literate-programming.html"><i class="fa fa-check"></i><b>6</b> literate programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="literate-programming.html"><a href="literate-programming.html#projects-are-directories"><i class="fa fa-check"></i><b>6.1</b> projects are directories</a></li>
<li class="chapter" data-level="6.2" data-path="literate-programming.html"><a href="literate-programming.html#scripts-are-files-of-code"><i class="fa fa-check"></i><b>6.2</b> scripts are files of code</a></li>
<li class="chapter" data-level="6.3" data-path="literate-programming.html"><a href="literate-programming.html#r-markdown-quarto-documents-combine-scripts-with-comments-and-once-knit-results"><i class="fa fa-check"></i><b>6.3</b> R markdown / Quarto documents combine scripts with comments and (once knit) results</a></li>
<li class="chapter" data-level="6.4" data-path="literate-programming.html"><a href="literate-programming.html#some-elements-of-coding-style"><i class="fa fa-check"></i><b>6.4</b> some elements of coding style</a></li>
<li class="chapter" data-level="6.5" data-path="literate-programming.html"><a href="literate-programming.html#what-to-do-when-you-are-stuck"><i class="fa fa-check"></i><b>6.5</b> What to do when you are stuck</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html"><i class="fa fa-check"></i><b>7</b> principles of data visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#some-opening-thoughts"><i class="fa fa-check"></i><b>7.1</b> some opening thoughts</a></li>
<li class="chapter" data-level="7.2" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#some-early-graphs"><i class="fa fa-check"></i><b>7.2</b> some early graphs</a></li>
<li class="chapter" data-level="7.3" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#tukey-and-eda"><i class="fa fa-check"></i><b>7.3</b> Tukey and EDA</a></li>
<li class="chapter" data-level="7.4" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#approaches-to-graphs"><i class="fa fa-check"></i><b>7.4</b> approaches to graphs</a></li>
<li class="chapter" data-level="7.5" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#tufte-first-principles"><i class="fa fa-check"></i><b>7.5</b> Tufte: first principles</a></li>
<li class="chapter" data-level="7.6" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#the-politics-of-data-visualization"><i class="fa fa-check"></i><b>7.6</b> the politics of data visualization</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#poor-design-leads-to-an-uninformed-or-misinformed-world"><i class="fa fa-check"></i><b>7.6.1</b> poor design leads to an uninformed or misinformed world</a></li>
<li class="chapter" data-level="7.6.2" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#poor-design-can-be-a-tool-to-deceive"><i class="fa fa-check"></i><b>7.6.2</b> poor design can be a tool to deceive</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#the-psychology-of-data-visualization"><i class="fa fa-check"></i><b>7.7</b> the psychology of data visualization</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#the-power-of-animation"><i class="fa fa-check"></i><b>7.7.1</b> the power of animation</a></li>
<li class="chapter" data-level="7.7.2" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#telling-the-truth-when-the-truth-is-unclear"><i class="fa fa-check"></i><b>7.7.2</b> telling the truth when the truth is unclear</a></li>
<li class="chapter" data-level="7.7.3" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#visualizing-uncertainty"><i class="fa fa-check"></i><b>7.7.3</b> visualizing uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#exercises"><i class="fa fa-check"></i><b>7.8</b> exercises</a>
<ul>
<li class="chapter" data-level="" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#smartphone-sales"><i class="fa fa-check"></i>Smartphone sales</a></li>
<li class="chapter" data-level="" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#stand-your-ground"><i class="fa fa-check"></i>Stand your ground</a></li>
<li class="chapter" data-level="" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#big-businesses"><i class="fa fa-check"></i>Big businesses</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#further-reading-and-resources"><i class="fa fa-check"></i><b>7.9</b> further reading and resources</a></li>
<li class="chapter" data-level="7.10" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#addendum"><i class="fa fa-check"></i><b>7.10</b> addendum</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="principles-of-data-visualization.html"><a href="principles-of-data-visualization.html#some-notes-on-healy"><i class="fa fa-check"></i><b>7.10.1</b> some notes on Healy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization-in-r-with-ggplot.html"><a href="visualization-in-r-with-ggplot.html"><i class="fa fa-check"></i><b>8</b> visualization in R with ggplot</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualization-in-r-with-ggplot.html"><a href="visualization-in-r-with-ggplot.html#a-picture-words-numbers"><i class="fa fa-check"></i><b>8.1</b> a picture &gt; (words, numbers)?</a></li>
<li class="chapter" data-level="8.2" data-path="visualization-in-r-with-ggplot.html"><a href="visualization-in-r-with-ggplot.html#read-wickhams-opening-chapter"><i class="fa fa-check"></i><b>8.2</b> Read Wickham’s opening chapter</a></li>
<li class="chapter" data-level="8.3" data-path="visualization-in-r-with-ggplot.html"><a href="visualization-in-r-with-ggplot.html#explore"><i class="fa fa-check"></i><b>8.3</b> explore</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html"><i class="fa fa-check"></i><b>9</b> on probability and statistics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#on-probability"><i class="fa fa-check"></i><b>9.1</b> on probability</a></li>
<li class="chapter" data-level="9.2" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#the-rules-of-probability"><i class="fa fa-check"></i><b>9.2</b> the rules of probability</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#keeping-conditional-probabilities-straight"><i class="fa fa-check"></i><b>9.2.1</b> keeping conditional probabilities straight</a></li>
<li class="chapter" data-level="9.2.2" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#exercises-1"><i class="fa fa-check"></i><b>9.2.2</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#continuous-probability-distributions"><i class="fa fa-check"></i><b>9.3</b> continuous probability distributions</a></li>
<li class="chapter" data-level="9.4" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#dangerous-equations"><i class="fa fa-check"></i><b>9.4</b> dangerous equations</a></li>
<li class="chapter" data-level="9.5" data-path="on-probability-and-statistics.html"><a href="on-probability-and-statistics.html#notes-for-next-revision"><i class="fa fa-check"></i><b>9.5</b> notes for next revision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html"><i class="fa fa-check"></i><b>10</b> reproducibility and the replication crisis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#answers-to-the-reproducibility-crisis"><i class="fa fa-check"></i><b>10.1</b> answers to the reproducibility crisis</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#partial-answer-1-tweak-or-abandon-nhst"><i class="fa fa-check"></i><b>10.1.1</b> partial answer 1: Tweak or abandon NHST</a></li>
<li class="chapter" data-level="10.1.2" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#partial-answer-2-keep-a-log-of-every-step-of-every-analysis-in-r-markdown-or-jupyter-notebooks"><i class="fa fa-check"></i><b>10.1.2</b> partial answer 2: Keep a log of every step of every analysis in R markdown or Jupyter notebooks</a></li>
<li class="chapter" data-level="10.1.3" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#partial-answer-3-pre-registration-of-your-research"><i class="fa fa-check"></i><b>10.1.3</b> partial answer 3: Pre-registration of your research</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#further-readings"><i class="fa fa-check"></i><b>10.2</b> further readings</a></li>
<li class="chapter" data-level="10.3" data-path="reproducibility-and-the-replication-crisis.html"><a href="reproducibility-and-the-replication-crisis.html#notes-for-next-revision-1"><i class="fa fa-check"></i><b>10.3</b> notes for next revision</a></li>
</ul></li>
<li class="part"><span><b>I Part III Towards data proficiency</b></span></li>
<li class="chapter" data-level="11" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html"><i class="fa fa-check"></i><b>11</b> wrangling and tidying</a>
<ul>
<li class="chapter" data-level="11.1" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html#the-structure-of-the-tidyverse"><i class="fa fa-check"></i><b>11.1</b> the structure of the tidyverse</a></li>
<li class="chapter" data-level="11.2" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html#where-should-we-eat"><i class="fa fa-check"></i><b>11.2</b> where should we eat?</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html#tall-and-wide-formats"><i class="fa fa-check"></i><b>11.2.1</b> tall and wide formats</a></li>
<li class="chapter" data-level="11.2.2" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html#exercises-2"><i class="fa fa-check"></i><b>11.2.2</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="wrangling-and-tidying.html"><a href="wrangling-and-tidying.html#more-on-tidy-coding"><i class="fa fa-check"></i><b>11.3</b> more on tidy coding</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html"><i class="fa fa-check"></i><b>12</b> finding, exploring, cleaning, and combining data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#florida-educational-data"><i class="fa fa-check"></i><b>12.1</b> florida educational data</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#a-digression-slash-windows-and-the-world."><i class="fa fa-check"></i><b>12.1.1</b> a digression: Slash, Windows and the world.</a></li>
<li class="chapter" data-level="12.1.2" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#getting-data-from-our-machine-into-r"><i class="fa fa-check"></i><b>12.1.2</b> getting data from our machine into R</a></li>
<li class="chapter" data-level="12.1.3" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#which-ones-are-high-schools"><i class="fa fa-check"></i><b>12.1.3</b> which ones are “high schools”?</a></li>
<li class="chapter" data-level="12.1.4" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#can-we-compute-district-county-means-from-these-data"><i class="fa fa-check"></i><b>12.1.4</b> can we compute district (county) means from these data?</a></li>
<li class="chapter" data-level="12.1.5" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#estimating-school-enrollments"><i class="fa fa-check"></i><b>12.1.5</b> estimating school enrollments</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#combining-datasets"><i class="fa fa-check"></i><b>12.2</b> combining datasets</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#challenges-in-joining-datasets"><i class="fa fa-check"></i><b>12.2.1</b> challenges in joining datasets</a></li>
<li class="chapter" data-level="12.2.2" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#some-approaches-to-fixing-the-data"><i class="fa fa-check"></i><b>12.2.2</b> some approaches to fixing the data</a></li>
<li class="chapter" data-level="12.2.3" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#estimating-the-relationship-between-economic-disadvantage-and-graduation-rates"><i class="fa fa-check"></i><b>12.2.3</b> estimating the relationship between economic disadvantage and graduation rates</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="finding-exploring-cleaning-and-combining-data.html"><a href="finding-exploring-cleaning-and-combining-data.html#recap-on-joining-files"><i class="fa fa-check"></i><b>12.3</b> recap / on joining files</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="applied-data-science.html"><a href="applied-data-science.html"><i class="fa fa-check"></i><b>13</b> applied data science</a>
<ul>
<li class="chapter" data-level="13.1" data-path="applied-data-science.html"><a href="applied-data-science.html#public-health-and-covid"><i class="fa fa-check"></i><b>13.1</b> public health and covid</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="applied-data-science.html"><a href="applied-data-science.html#covid-data-in-2025"><i class="fa fa-check"></i><b>13.1.1</b> COVID data in 2025</a></li>
<li class="chapter" data-level="13.1.2" data-path="applied-data-science.html"><a href="applied-data-science.html#a-brief-digression-on-causality"><i class="fa fa-check"></i><b>13.1.2</b> a brief digression on causality</a></li>
<li class="chapter" data-level="13.1.3" data-path="applied-data-science.html"><a href="applied-data-science.html#the-excess-mortality-package"><i class="fa fa-check"></i><b>13.1.3</b> the excess mortality package</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="applied-data-science.html"><a href="applied-data-science.html#other-datasets-in-and-beyond-r"><i class="fa fa-check"></i><b>13.2</b> other datasets in and beyond R</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="applied-data-science.html"><a href="applied-data-science.html#makeextractcombine-your-own-data"><i class="fa fa-check"></i><b>13.2.1</b> make/extract/combine your own data</a></li>
<li class="chapter" data-level="13.2.2" data-path="applied-data-science.html"><a href="applied-data-science.html#keep-it-manageable"><i class="fa fa-check"></i><b>13.2.2</b> keep it manageable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html"><i class="fa fa-check"></i><b>14</b> strings, factors, dates, and times</a>
<ul>
<li class="chapter" data-level="14.1" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#strings"><i class="fa fa-check"></i><b>14.1</b> strings</a></li>
<li class="chapter" data-level="14.2" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#factors"><i class="fa fa-check"></i><b>14.2</b> factors</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#types-of-babies"><i class="fa fa-check"></i><b>14.2.1</b> types of babies</a></li>
<li class="chapter" data-level="14.2.2" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#types-of-grown-ups"><i class="fa fa-check"></i><b>14.2.2</b> types of grown-ups</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#dates"><i class="fa fa-check"></i><b>14.3</b> dates</a></li>
<li class="chapter" data-level="14.4" data-path="strings-factors-dates-and-times.html"><a href="strings-factors-dates-and-times.html#times"><i class="fa fa-check"></i><b>14.4</b> times</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i><b>15</b> lists</a></li>
<li class="chapter" data-level="16" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html"><i class="fa fa-check"></i><b>16</b> loops, functions, and beyond</a>
<ul>
<li class="chapter" data-level="16.1" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#loops"><i class="fa fa-check"></i><b>16.1</b> loops</a></li>
<li class="chapter" data-level="16.2" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#from-loop-to-apply-to-purrrmap"><i class="fa fa-check"></i><b>16.2</b> from loop to apply to purrr::map</a></li>
<li class="chapter" data-level="16.3" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#some-examples-of-functions"><i class="fa fa-check"></i><b>16.3</b> some examples of functions</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#preliminaries"><i class="fa fa-check"></i><b>16.3.1</b> preliminaries</a></li>
<li class="chapter" data-level="16.3.2" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#the-function"><i class="fa fa-check"></i><b>16.3.2</b> the function</a></li>
<li class="chapter" data-level="16.3.3" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#applying-the-function"><i class="fa fa-check"></i><b>16.3.3</b> applying the function</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="loops-functions-and-beyond.html"><a href="loops-functions-and-beyond.html#how-many-bottles-of-what"><i class="fa fa-check"></i><b>16.4</b> how many bottles of what?</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="from-correlation-to-multiple-regression.html"><a href="from-correlation-to-multiple-regression.html"><i class="fa fa-check"></i><b>17</b> from correlation to multiple regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="from-correlation-to-multiple-regression.html"><a href="from-correlation-to-multiple-regression.html#bivariate-analysis-galtons-height-data"><i class="fa fa-check"></i><b>17.1</b> bivariate analysis: Galton’s height data</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="from-correlation-to-multiple-regression.html"><a href="from-correlation-to-multiple-regression.html#correlations-based-on-small-samples-are-unstable-a-monte-carlo-demonstration"><i class="fa fa-check"></i><b>17.1.1</b> correlations based on small samples are unstable: A Monte Carlo demonstration</a></li>
<li class="chapter" data-level="17.1.2" data-path="from-correlation-to-multiple-regression.html"><a href="from-correlation-to-multiple-regression.html#from-correlation-to-regression"><i class="fa fa-check"></i><b>17.1.2</b> from correlation to regression</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="from-correlation-to-multiple-regression.html"><a href="from-correlation-to-multiple-regression.html#multivariate-data"><i class="fa fa-check"></i><b>17.2</b> multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>18</b> cross-validation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="cross-validation.html"><a href="cross-validation.html#revisiting-the-affairs-data"><i class="fa fa-check"></i><b>18.1</b> revisiting the affairs data</a></li>
<li class="chapter" data-level="18.2" data-path="cross-validation.html"><a href="cross-validation.html#avoiding-capitalizing-on-chance"><i class="fa fa-check"></i><b>18.2</b> avoiding capitalizing on chance</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="cross-validation.html"><a href="cross-validation.html#splitting-the-data-into-training-and-test-subsamples"><i class="fa fa-check"></i><b>18.2.1</b> splitting the data into training and test subsamples</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="cross-validation.html"><a href="cross-validation.html#an-example-of-cross-validated-linear-regression"><i class="fa fa-check"></i><b>18.3</b> an example of cross-validated linear regression</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="cross-validation.html"><a href="cross-validation.html#applying-logistic-regression-analysis-to-the-training-data"><i class="fa fa-check"></i><b>18.3.1</b> applying logistic regression analysis to the training data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html"><i class="fa fa-check"></i><b>19</b> prediction and classification</a>
<ul>
<li class="chapter" data-level="19.1" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#from-regression-to-classification-selection-of-a-threshold"><i class="fa fa-check"></i><b>19.1</b> from regression to classification: selection of a threshold</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#applying-the-model-to-the-test-data"><i class="fa fa-check"></i><b>19.1.1</b> applying the model to the test data</a></li>
<li class="chapter" data-level="19.1.2" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#changing-our-decision-threshold"><i class="fa fa-check"></i><b>19.1.2</b> changing our decision threshold</a></li>
<li class="chapter" data-level="19.1.3" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#more-confusion"><i class="fa fa-check"></i><b>19.1.3</b> more confusion</a></li>
<li class="chapter" data-level="19.1.4" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#rocs-and-auc"><i class="fa fa-check"></i><b>19.1.4</b> ROCs and AUC</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#another-approach-to-classification-k-nearest-neighbor"><i class="fa fa-check"></i><b>19.2</b> another approach to classification: k-nearest neighbor</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#application-the-affairs-data"><i class="fa fa-check"></i><b>19.2.1</b> application: the affairs data</a></li>
<li class="chapter" data-level="19.2.2" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#from-one-doppelganger-to-many"><i class="fa fa-check"></i><b>19.2.2</b> from one doppelganger to many</a></li>
<li class="chapter" data-level="19.2.3" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#the-bayesian-classifier"><i class="fa fa-check"></i><b>19.2.3</b> the Bayesian classifier</a></li>
<li class="chapter" data-level="19.2.4" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#back-to-the-affairs-data"><i class="fa fa-check"></i><b>19.2.4</b> Back to the affairs data</a></li>
<li class="chapter" data-level="19.2.5" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#avoiding-capitalization-on-chance-again"><i class="fa fa-check"></i><b>19.2.5</b> avoiding capitalization on chance (again)</a></li>
<li class="chapter" data-level="19.2.6" data-path="prediction-and-classification.html"><a href="prediction-and-classification.html#the-multinomial-case"><i class="fa fa-check"></i><b>19.2.6</b> the multinomial case</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><i class="fa fa-check"></i><b>20</b> machine learning: chihuahuas vs muffins, and other distinctions and ideas</a>
<ul>
<li class="chapter" data-level="20.1" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#supervised-versus-unsupervised"><i class="fa fa-check"></i><b>20.1</b> supervised versus unsupervised</a></li>
<li class="chapter" data-level="20.2" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#prediction-versus-classification"><i class="fa fa-check"></i><b>20.2</b> prediction versus classification</a></li>
<li class="chapter" data-level="20.3" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#understanding-versus-prediction"><i class="fa fa-check"></i><b>20.3</b> understanding versus prediction</a></li>
<li class="chapter" data-level="20.4" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#bias-versus-variability"><i class="fa fa-check"></i><b>20.4</b> bias versus variability</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#resampling-beyond-test-training-and-validation-samples"><i class="fa fa-check"></i><b>20.4.1</b> resampling: beyond test, training, and validation samples</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#compensatory-versus-non-compensatory-problems"><i class="fa fa-check"></i><b>20.5</b> compensatory versus non-compensatory problems</a></li>
<li class="chapter" data-level="20.6" data-path="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html"><a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html#a-postscript-the-tidymodels-packages"><i class="fa fa-check"></i><b>20.6</b> a postscript: The Tidymodels packages</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html"><i class="fa fa-check"></i><b>21</b> working with text: a case study</a>
<ul>
<li class="chapter" data-level="21.1" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#federal-workers"><i class="fa fa-check"></i><b>21.1</b> federal workers</a></li>
<li class="chapter" data-level="21.2" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#finding-reddit-data"><i class="fa fa-check"></i><b>21.2</b> finding Reddit data</a></li>
<li class="chapter" data-level="21.3" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#some-initial-observations"><i class="fa fa-check"></i><b>21.3</b> some initial observations</a></li>
<li class="chapter" data-level="21.4" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#preprocessing"><i class="fa fa-check"></i><b>21.4</b> preprocessing</a></li>
<li class="chapter" data-level="21.5" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#comparing-the-words-and-stems"><i class="fa fa-check"></i><b>21.5</b> comparing the words and stems</a></li>
<li class="chapter" data-level="21.6" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#construction-of-differential-word-clouds"><i class="fa fa-check"></i><b>21.6</b> Construction of differential word clouds</a></li>
<li class="chapter" data-level="21.7" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#bigrams"><i class="fa fa-check"></i><b>21.7</b> bigrams</a></li>
<li class="chapter" data-level="21.8" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#categories-of-words"><i class="fa fa-check"></i><b>21.8</b> categories of words</a></li>
<li class="chapter" data-level="21.9" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#code-for-assessing-liwc-effect-sizes-between-2-groups"><i class="fa fa-check"></i><b>21.9</b> Code for assessing LIWC effect sizes between 2 groups</a></li>
<li class="chapter" data-level="21.10" data-path="working-with-text-a-case-study.html"><a href="working-with-text-a-case-study.html#exercise-what-would-you-do-next"><i class="fa fa-check"></i><b>21.10</b> exercise: what would you do next?</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html"><i class="fa fa-check"></i><b>22</b> an introduction to networks</a>
<ul>
<li class="chapter" data-level="22.1" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#key-network-concepts"><i class="fa fa-check"></i><b>22.1</b> key network concepts</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#a-simple-example-networks-and-balance-theory"><i class="fa fa-check"></i><b>22.1.1</b> a simple example: networks and balance theory</a></li>
<li class="chapter" data-level="22.1.2" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#centrality"><i class="fa fa-check"></i><b>22.1.2</b> centrality</a></li>
<li class="chapter" data-level="22.1.3" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#components-and-communities"><i class="fa fa-check"></i><b>22.1.3</b> components and communities</a></li>
<li class="chapter" data-level="22.1.4" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#another-example-its-a-small-world"><i class="fa fa-check"></i><b>22.1.4</b> another example: it’s a small world</a></li>
<li class="chapter" data-level="22.1.5" data-path="an-introduction-to-networks.html"><a href="an-introduction-to-networks.html#static-and-dynamic-networks"><i class="fa fa-check"></i><b>22.1.5</b> static and dynamic networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html"><i class="fa fa-check"></i><b>23</b> case study: the network structure of computational social science</a>
<ul>
<li class="chapter" data-level="23.0.1" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html#from-citation-network-to-structural-network"><i class="fa fa-check"></i><b>23.0.1</b> from citation network to structural network</a></li>
<li class="chapter" data-level="23.0.2" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html#looking-at-the-whole-citation-network"><i class="fa fa-check"></i><b>23.0.2</b> looking at the whole citation network</a></li>
<li class="chapter" data-level="23.0.3" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html#the-structural-network-centrality-and-community-structure"><i class="fa fa-check"></i><b>23.0.3</b> the structural network: Centrality and community structure</a></li>
<li class="chapter" data-level="23.0.4" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html#visualizing-the-network"><i class="fa fa-check"></i><b>23.0.4</b> visualizing the network</a></li>
<li class="chapter" data-level="23.0.5" data-path="case-study-the-network-structure-of-computational-social-science.html"><a href="case-study-the-network-structure-of-computational-social-science.html#exploring-the-communities"><i class="fa fa-check"></i><b>23.0.5</b> exploring the communities</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html"><i class="fa fa-check"></i><b>24</b> some ethical concerns for the data scientist</a>
<ul>
<li class="chapter" data-level="24.1" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#ethics-and-personality-harvesting"><i class="fa fa-check"></i><b>24.1</b> ethics and personality harvesting</a></li>
<li class="chapter" data-level="24.2" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#the-law-of-unintended-consequences"><i class="fa fa-check"></i><b>24.2</b> the law of unintended consequences</a></li>
<li class="chapter" data-level="24.3" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#your-privacy-is-my-concern"><i class="fa fa-check"></i><b>24.3</b> your privacy is my concern</a></li>
<li class="chapter" data-level="24.4" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#who-should-hold-the-digital-keys"><i class="fa fa-check"></i><b>24.4</b> who should hold the digital keys?</a></li>
<li class="chapter" data-level="24.5" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#contact-tracing-and-covid-19"><i class="fa fa-check"></i><b>24.5</b> contact-tracing and COVID-19</a></li>
<li class="chapter" data-level="24.6" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#the-digital-divide"><i class="fa fa-check"></i><b>24.6</b> the digital divide</a></li>
<li class="chapter" data-level="24.7" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#still-more-case-studies"><i class="fa fa-check"></i><b>24.7</b> still more case studies</a></li>
<li class="chapter" data-level="24.8" data-path="some-ethical-concerns-for-the-data-scientist.html"><a href="some-ethical-concerns-for-the-data-scientist.html#some-potential-remedies"><i class="fa fa-check"></i><b>24.8</b> some potential remedies</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data science for the liberal arts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prediction-and-classification" class="section level1 hasAnchor" number="19">
<h1><span class="header-section-number">19</span> prediction and classification<a href="prediction-and-classification.html#prediction-and-classification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If we want to classify people, we will need to create a decision threshold at which we will change our prediction from ‘no’ to ‘yes’.</p>
<div id="from-regression-to-classification-selection-of-a-threshold" class="section level2 hasAnchor" number="19.1">
<h2><span class="header-section-number">19.1</span> from regression to classification: selection of a threshold<a href="prediction-and-classification.html#from-regression-to-classification-selection-of-a-threshold" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will continue to work with the affairs data; here’s the relevant code from last chapter:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="prediction-and-classification.html#cb160-1" tabindex="-1"></a><span class="co"># code from last chapter on Fair data</span></span>
<span id="cb160-2"><a href="prediction-and-classification.html#cb160-2" tabindex="-1"></a>Fair <span class="ot">&lt;-</span> Fair <span class="sc">%&gt;%</span> </span>
<span id="cb160-3"><a href="prediction-and-classification.html#cb160-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rootAffair =</span> </span>
<span id="cb160-4"><a href="prediction-and-classification.html#cb160-4" tabindex="-1"></a>              <span class="fu">as.integer</span>(<span class="fu">sqrt</span>(nbaffairs))) <span class="sc">%&gt;%</span> </span>
<span id="cb160-5"><a href="prediction-and-classification.html#cb160-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">affairYN =</span></span>
<span id="cb160-6"><a href="prediction-and-classification.html#cb160-6" tabindex="-1"></a>               <span class="fu">ifelse</span> (nbaffairs <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb160-7"><a href="prediction-and-classification.html#cb160-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb160-8"><a href="prediction-and-classification.html#cb160-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Fair)</span>
<span id="cb160-9"><a href="prediction-and-classification.html#cb160-9" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> <span class="fu">round</span>(<span class="fl">0.6</span><span class="sc">*</span>n),</span>
<span id="cb160-10"><a href="prediction-and-classification.html#cb160-10" tabindex="-1"></a>                     <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb160-11"><a href="prediction-and-classification.html#cb160-11" tabindex="-1"></a>trainFair <span class="ot">&lt;-</span> Fair[trainIndex ,]</span>
<span id="cb160-12"><a href="prediction-and-classification.html#cb160-12" tabindex="-1"></a>testFair <span class="ot">&lt;-</span> Fair[<span class="sc">-</span>trainIndex ,]</span>
<span id="cb160-13"><a href="prediction-and-classification.html#cb160-13" tabindex="-1"></a>trainFair2 <span class="ot">&lt;-</span> trainFair <span class="sc">%&gt;%</span></span>
<span id="cb160-14"><a href="prediction-and-classification.html#cb160-14" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>nbaffairs, <span class="sc">-</span>affairYN)</span>
<span id="cb160-15"><a href="prediction-and-classification.html#cb160-15" tabindex="-1"></a>testFair2 <span class="ot">&lt;-</span> testFair <span class="sc">%&gt;%</span></span>
<span id="cb160-16"><a href="prediction-and-classification.html#cb160-16" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>nbaffairs, <span class="sc">-</span>affairYN)</span>
<span id="cb160-17"><a href="prediction-and-classification.html#cb160-17" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(rootAffair <span class="sc">~</span> .,</span>
<span id="cb160-18"><a href="prediction-and-classification.html#cb160-18" tabindex="-1"></a>             <span class="at">data =</span> trainFair2)</span>
<span id="cb160-19"><a href="prediction-and-classification.html#cb160-19" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rootAffair ~ ., data = trainFair2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6655 -0.4923 -0.2180  0.1444  2.7593 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.974758   0.385662   5.120 5.03e-07 ***
## sexmale     -0.045067   0.106127  -0.425   0.6713    
## age         -0.014193   0.007835  -1.812   0.0709 .  
## ym           0.038914   0.013901   2.799   0.0054 ** 
## childyes     0.027497   0.116926   0.235   0.8142    
## religious   -0.090619   0.038503  -2.354   0.0191 *  
## education   -0.018241   0.021963  -0.831   0.4068    
## occupation   0.061293   0.030904   1.983   0.0481 *  
## rate        -0.265213   0.042161  -6.291 9.39e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8224 on 352 degrees of freedom
## Multiple R-squared:  0.1783, Adjusted R-squared:  0.1597 
## F-statistic: 9.549 on 8 and 352 DF,  p-value: 5.595e-12</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="prediction-and-classification.html#cb162-1" tabindex="-1"></a>predictTrain <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, trainFair, </span>
<span id="cb162-2"><a href="prediction-and-classification.html#cb162-2" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>To maximise overall prediction, we will create a threshold equal to the actual proportion of people who don’t have affairs in our sample:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="prediction-and-classification.html#cb163-1" tabindex="-1"></a>(threshold <span class="ot">&lt;-</span> <span class="fu">mean</span>(trainFair<span class="sc">$</span>affairYN))</span></code></pre></div>
<pre><code>## [1] 0.2548476</code></pre>
<p>This is equal to both the mean of our predicted scores (above) and the mean of our actual scores, and, because this is a dichotomous variable, the proportion of people in the sample who have affairs. We’ll predict that if a person has a predicted score more than this we’ll predict that s/he will be unfaithful, else we will “PredictOK.” Then we will create a <em>confusion matrix,</em> to compare our correct predictions (PredictOK and affairYN = 1, Predictunfaithful and affairYN = 0) with the remainder.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="prediction-and-classification.html#cb165-1" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictTrain <span class="sc">&gt;</span> threshold,</span>
<span id="cb165-2"><a href="prediction-and-classification.html#cb165-2" tabindex="-1"></a>                         <span class="st">&quot;Predictunfaithful&quot;</span>, <span class="st">&quot;PredictOK&quot;</span>)</span>
<span id="cb165-3"><a href="prediction-and-classification.html#cb165-3" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">table</span>(classification, trainFair<span class="sc">$</span>affairYN))</span></code></pre></div>
<pre><code>##                    
## classification        0   1
##   PredictOK         107  18
##   Predictunfaithful 162  74</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="prediction-and-classification.html#cb167-1" tabindex="-1"></a>(correct <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 181</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="prediction-and-classification.html#cb169-1" tabindex="-1"></a>(errors <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 180</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="prediction-and-classification.html#cb171-1" tabindex="-1"></a>(accuracy <span class="ot">&lt;-</span> correct<span class="sc">/</span>(correct <span class="sc">+</span> errors))</span></code></pre></div>
<pre><code>## [1] 0.501385</code></pre>
<div id="applying-the-model-to-the-test-data" class="section level3 hasAnchor" number="19.1.1">
<h3><span class="header-section-number">19.1.1</span> applying the model to the test data<a href="prediction-and-classification.html#applying-the-model-to-the-test-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We shouldn’t trust these results, though, because the model is based on the same data that it is tested upon. Now we will apply the model to the test data. With the linear regression model above, we examined ‘shrinkage’ in the overall R-square. Here, we can assess shrinkage in terms of the percent of erroneous classifications.</p>
<p>Typically (but not invariably), the percent of accurate classifications will decline, especially if the model is a complex one with many variables or if the number of observations is low.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="prediction-and-classification.html#cb173-1" tabindex="-1"></a>predictTest <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, testFair, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb173-2"><a href="prediction-and-classification.html#cb173-2" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictTest <span class="sc">&gt;</span> threshold,</span>
<span id="cb173-3"><a href="prediction-and-classification.html#cb173-3" tabindex="-1"></a>                         <span class="st">&quot;Predictunfaithful&quot;</span>, <span class="st">&quot;PredictOK&quot;</span>)</span>
<span id="cb173-4"><a href="prediction-and-classification.html#cb173-4" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">table</span>(classification, testFair<span class="sc">$</span>affairYN))</span></code></pre></div>
<pre><code>##                    
## classification        0   1
##   PredictOK          73   9
##   Predictunfaithful 109  49</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="prediction-and-classification.html#cb175-1" tabindex="-1"></a>(correct <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 122</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="prediction-and-classification.html#cb177-1" tabindex="-1"></a>(errors <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 118</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="prediction-and-classification.html#cb179-1" tabindex="-1"></a>(accuracy <span class="ot">&lt;-</span> correct<span class="sc">/</span>(correct <span class="sc">+</span> errors))</span></code></pre></div>
<pre><code>## [1] 0.5083333</code></pre>
<p>On the test data, we are correct 51 percent of the time. This describes our <em>out of sample risk.</em></p>
</div>
<div id="changing-our-decision-threshold" class="section level3 hasAnchor" number="19.1.2">
<h3><span class="header-section-number">19.1.2</span> changing our decision threshold<a href="prediction-and-classification.html#changing-our-decision-threshold" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In many decision problems, there is an asymmetry in the cost of different types of errors: if you are foraging for mushrooms, for example, an error of the form (you decide its safe and it is poisonous) is more costly than the converse (you decide its poisonous and it is safe).</p>
<p>This may be true in the present example as well. Consider someone who is looking for a spouse, but is really averse to the idea of getting hurt by an affair. That person might feel like the cost of marrying an unfaithful person is much greater than the cost of not marrying a faithful one. So we adjust the threshold downwards:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="prediction-and-classification.html#cb181-1" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb181-2"><a href="prediction-and-classification.html#cb181-2" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictTest <span class="sc">&gt;</span> threshold,</span>
<span id="cb181-3"><a href="prediction-and-classification.html#cb181-3" tabindex="-1"></a>                         <span class="st">&quot;Predictunfaithful&quot;</span>, <span class="st">&quot;PredictOK&quot;</span>)</span>
<span id="cb181-4"><a href="prediction-and-classification.html#cb181-4" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">table</span>(classification, testFair<span class="sc">$</span>affairYN))</span></code></pre></div>
<pre><code>##                    
## classification        0   1
##   PredictOK          27   3
##   Predictunfaithful 155  55</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="prediction-and-classification.html#cb183-1" tabindex="-1"></a>(correct <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 82</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="prediction-and-classification.html#cb185-1" tabindex="-1"></a>(errors <span class="ot">&lt;-</span>  b[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 158</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="prediction-and-classification.html#cb187-1" tabindex="-1"></a>(accuracy <span class="ot">&lt;-</span> correct<span class="sc">/</span>(correct <span class="sc">+</span> errors))</span></code></pre></div>
<pre><code>## [1] 0.3416667</code></pre>
<p>The “overall accuracy” - that is, number of correct classifications - drops. But that’s not what we are really interested in, rather, we are interested in minimizing hurt.</p>
<p>Here’s another example: Someone who is very lonely might feel the opposite, and be willing to accept greater substantially greater risk.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="prediction-and-classification.html#cb189-1" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb189-2"><a href="prediction-and-classification.html#cb189-2" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictTest <span class="sc">&gt;</span> threshold,</span>
<span id="cb189-3"><a href="prediction-and-classification.html#cb189-3" tabindex="-1"></a>                         <span class="st">&quot;Predictunfaithful&quot;</span>, <span class="st">&quot;PredictOK&quot;</span>)</span>
<span id="cb189-4"><a href="prediction-and-classification.html#cb189-4" tabindex="-1"></a>(b <span class="ot">&lt;-</span> <span class="fu">table</span>(classification, testFair<span class="sc">$</span>affairYN))</span></code></pre></div>
<pre><code>##                    
## classification        0   1
##   PredictOK         111  21
##   Predictunfaithful  71  37</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="prediction-and-classification.html#cb191-1" tabindex="-1"></a>(correct <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 148</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="prediction-and-classification.html#cb193-1" tabindex="-1"></a>(errors <span class="ot">&lt;-</span> b[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">2</span>,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 92</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="prediction-and-classification.html#cb195-1" tabindex="-1"></a>(accuracy <span class="ot">&lt;-</span> correct<span class="sc">/</span>(correct <span class="sc">+</span> errors))</span></code></pre></div>
<pre><code>## [1] 0.6166667</code></pre>
<p>Prediction is higher here - but not much higher than it would be if we raised the threshold even further, and just assumed that everyone can be trusted. Then, our error rate would be 25 percent. When overall predictability is low, it’s often the case that you can maximize correct predictions by simply predicting that everyone will be in the most popular category. Predicting rare events, such as suicides, is particularly difficult.</p>
</div>
<div id="more-confusion" class="section level3 hasAnchor" number="19.1.3">
<h3><span class="header-section-number">19.1.3</span> more confusion<a href="prediction-and-classification.html#more-confusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a nice shortcut to generating confusion matrices such as those above using the caret package.</p>
<p>This function describes outcomes in several ways, as there are many languages for describing outcomes in 2 x 2 tables, including Type I vs. Type II errors, Hits vs. False Alarms/False Positives, and Sensitivity vs. Specificity.</p>
<p>In these data, it’s been set up so that</p>
<ul>
<li>hit rate ~ sensitivity ~ (“no affair” | no affair)</li>
<li>correct rejection ~ specificity ~ (“affair” | affair)</li>
</ul>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="prediction-and-classification.html#cb197-1" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb197-2"><a href="prediction-and-classification.html#cb197-2" tabindex="-1"></a><span class="co"># syntax for classification in caret is a little different</span></span>
<span id="cb197-3"><a href="prediction-and-classification.html#cb197-3" tabindex="-1"></a><span class="co"># (the labels for the actual and predicted scores have to be the same)</span></span>
<span id="cb197-4"><a href="prediction-and-classification.html#cb197-4" tabindex="-1"></a><span class="co">#classification &lt;- ifelse(predictTest &gt; threshold,</span></span>
<span id="cb197-5"><a href="prediction-and-classification.html#cb197-5" tabindex="-1"></a><span class="co">#                         &quot;Predictunfaithful&quot;, &quot;PredictOK&quot;)</span></span>
<span id="cb197-6"><a href="prediction-and-classification.html#cb197-6" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictTest <span class="sc">&gt;</span> threshold, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb197-7"><a href="prediction-and-classification.html#cb197-7" tabindex="-1"></a><span class="co"># caret package (newest) requires explicit matching of factors</span></span>
<span id="cb197-8"><a href="prediction-and-classification.html#cb197-8" tabindex="-1"></a>classification <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(classification)</span>
<span id="cb197-9"><a href="prediction-and-classification.html#cb197-9" tabindex="-1"></a>testFair<span class="sc">$</span>affairYN <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testFair<span class="sc">$</span>affairYN)</span>
<span id="cb197-10"><a href="prediction-and-classification.html#cb197-10" tabindex="-1"></a><span class="fu">confusionMatrix</span>(classification, testFair<span class="sc">$</span>affairYN)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 111  21
##          1  71  37
##                                           
##                Accuracy : 0.6167          
##                  95% CI : (0.5519, 0.6785)
##     No Information Rate : 0.7583          
##     P-Value [Acc &gt; NIR] : 1               
##                                           
##                   Kappa : 0.1916          
##                                           
##  Mcnemar&#39;s Test P-Value : 3.245e-07       
##                                           
##             Sensitivity : 0.6099          
##             Specificity : 0.6379          
##          Pos Pred Value : 0.8409          
##          Neg Pred Value : 0.3426          
##              Prevalence : 0.7583          
##          Detection Rate : 0.4625          
##    Detection Prevalence : 0.5500          
##       Balanced Accuracy : 0.6239          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
</div>
<div id="rocs-and-auc" class="section level3 hasAnchor" number="19.1.4">
<h3><span class="header-section-number">19.1.4</span> ROCs and AUC<a href="prediction-and-classification.html#rocs-and-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each of these decision thresholds describes the performance of a model at a particular point. We can combine the thresholds and plot them in Receiver Operating Characteristic (ROC) curves. The area under the curve (AUC) is a great measure of model accuracy, in that it summarizes how effective a classifier is across all possible thresholds.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="prediction-and-classification.html#cb199-1" tabindex="-1"></a><span class="co"># fig.width and fig.height specified to get square plots</span></span>
<span id="cb199-2"><a href="prediction-and-classification.html#cb199-2" tabindex="-1"></a><span class="co"># colAUC function gets stats etc</span></span>
<span id="cb199-3"><a href="prediction-and-classification.html#cb199-3" tabindex="-1"></a>AUCModel <span class="ot">&lt;-</span> <span class="fu">colAUC</span>(predictTest, testFair[[<span class="st">&quot;affairYN&quot;</span>]], <span class="at">plotROC =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="DataSciLibArts_files/figure-html/0414model1ROC-1.png" width="480" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="prediction-and-classification.html#cb200-1" tabindex="-1"></a>AUCModel</span></code></pre></div>
<pre><code>##              [,1]
## 0 vs. 1 0.6662562</code></pre>
</div>
</div>
<div id="another-approach-to-classification-k-nearest-neighbor" class="section level2 hasAnchor" number="19.2">
<h2><span class="header-section-number">19.2</span> another approach to classification: k-nearest neighbor<a href="prediction-and-classification.html#another-approach-to-classification-k-nearest-neighbor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Real-life social predictions are often guided not by induction or the (optimized) combination of a set of predictor variables. Rather, we often reason by analogy - we might think, for example, that <em>I won’t go out with Fred because he reminds me of Larry, and Larry was kind of a jerk.</em></p>
<p>If regression analysis is an approach to prediction based in our set of variables, <em>k-nearest neighbor</em> analysis instead makes predictions based on observations.</p>
<p>Formally, as described in the documentation for the knn package,</p>
<blockquote>
<p>For each row of the test set, the k nearest (in Euclidean distance) training set vectors are found, and the classification is decided by majority vote, with ties broken at random. (ref).</p>
</blockquote>
<p>In the simplest form of this analysis, we find the nearest thing to a “doppelganger” (a look-alike or near double) for a given observation. So, in the affairs data, if a person is most like someone else in the dataset who has had an affair, we predict an affair, else not.</p>
<div id="application-the-affairs-data" class="section level3 hasAnchor" number="19.2.1">
<h3><span class="header-section-number">19.2.1</span> application: the affairs data<a href="prediction-and-classification.html#application-the-affairs-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Begin by loading the affairs data from last time. Using the same seed (33458) means that the same set of training and test cases will be extracted as in the prior analysis</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="prediction-and-classification.html#cb202-1" tabindex="-1"></a><span class="fu">data</span>(Fair)</span>
<span id="cb202-2"><a href="prediction-and-classification.html#cb202-2" tabindex="-1"></a><span class="co"># one change here: Note the bidirectional pipe to simplify code</span></span>
<span id="cb202-3"><a href="prediction-and-classification.html#cb202-3" tabindex="-1"></a><span class="co"># use only when you are sure that your file update is ok</span></span>
<span id="cb202-4"><a href="prediction-and-classification.html#cb202-4" tabindex="-1"></a>Fair <span class="sc">%&lt;&gt;%</span> <span class="co"># &lt;- Fair %&gt;% </span></span>
<span id="cb202-5"><a href="prediction-and-classification.html#cb202-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">affairYN =</span></span>
<span id="cb202-6"><a href="prediction-and-classification.html#cb202-6" tabindex="-1"></a><span class="co"># nbaffairs is set up as a factor</span></span>
<span id="cb202-7"><a href="prediction-and-classification.html#cb202-7" tabindex="-1"></a><span class="co"># to allow confusionmatrix to run</span></span>
<span id="cb202-8"><a href="prediction-and-classification.html#cb202-8" tabindex="-1"></a>               <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(nbaffairs <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb202-9"><a href="prediction-and-classification.html#cb202-9" tabindex="-1"></a><span class="co"># unlike the lm and glm commands, knn will not automatically create our dummy # variables for us. so we need to do this manually.</span></span>
<span id="cb202-10"><a href="prediction-and-classification.html#cb202-10" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sexMale =</span> <span class="fu">ifelse</span>(sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-11"><a href="prediction-and-classification.html#cb202-11" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">childyes =</span> <span class="fu">ifelse</span>(child <span class="sc">==</span> <span class="st">&quot;no&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-12"><a href="prediction-and-classification.html#cb202-12" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>(<span class="fu">c</span>(sex,child,nbaffairs)))</span>
<span id="cb202-13"><a href="prediction-and-classification.html#cb202-13" tabindex="-1"></a></span>
<span id="cb202-14"><a href="prediction-and-classification.html#cb202-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb202-15"><a href="prediction-and-classification.html#cb202-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Fair)</span>
<span id="cb202-16"><a href="prediction-and-classification.html#cb202-16" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> <span class="fu">round</span>(<span class="fl">0.6</span><span class="sc">*</span>n), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb202-17"><a href="prediction-and-classification.html#cb202-17" tabindex="-1"></a><span class="co"># create training and test samples</span></span>
<span id="cb202-18"><a href="prediction-and-classification.html#cb202-18" tabindex="-1"></a>trainFair <span class="ot">&lt;-</span> Fair[trainIndex ,]</span>
<span id="cb202-19"><a href="prediction-and-classification.html#cb202-19" tabindex="-1"></a>testFair <span class="ot">&lt;-</span> Fair[<span class="sc">-</span>trainIndex ,]</span></code></pre></div>
<p>To run a k-nearest neighbor analysis, we need three inputs: our predictors in the training data, our predictors in the test data, and our outcome/classes in the training data.</p>
<p>Here, as in the regression analysis in the last chapter, we can generate a confusion matrix to assess the accuracy of prediction:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="prediction-and-classification.html#cb203-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb203-2"><a href="prediction-and-classification.html#cb203-2" tabindex="-1"></a>trainPredictors <span class="ot">&lt;-</span> trainFair <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="prediction-and-classification.html#cb203-3" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb203-4"><a href="prediction-and-classification.html#cb203-4" tabindex="-1"></a>testPredictors <span class="ot">&lt;-</span> testFair <span class="sc">%&gt;%</span></span>
<span id="cb203-5"><a href="prediction-and-classification.html#cb203-5" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb203-6"><a href="prediction-and-classification.html#cb203-6" tabindex="-1"></a>knnAffair <span class="ot">&lt;-</span> <span class="fu">knn</span>(trainPredictors, <span class="co"># training data</span></span>
<span id="cb203-7"><a href="prediction-and-classification.html#cb203-7" tabindex="-1"></a>             testPredictors, <span class="co"># test data</span></span>
<span id="cb203-8"><a href="prediction-and-classification.html#cb203-8" tabindex="-1"></a>             trainFair<span class="sc">$</span>affairYN, <span class="co"># class</span></span>
<span id="cb203-9"><a href="prediction-and-classification.html#cb203-9" tabindex="-1"></a>             <span class="dv">1</span> <span class="co"># number of neighbors</span></span>
<span id="cb203-10"><a href="prediction-and-classification.html#cb203-10" tabindex="-1"></a>             )</span>
<span id="cb203-11"><a href="prediction-and-classification.html#cb203-11" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(knnAffair, testFair<span class="sc">$</span>affairYN)</span>
<span id="cb203-12"><a href="prediction-and-classification.html#cb203-12" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 143  32
##          1  39  26
##                                           
##                Accuracy : 0.7042          
##                  95% CI : (0.6421, 0.7611)
##     No Information Rate : 0.7583          
##     P-Value [Acc &gt; NIR] : 0.9772          
##                                           
##                   Kappa : 0.2247          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.4764          
##                                           
##             Sensitivity : 0.7857          
##             Specificity : 0.4483          
##          Pos Pred Value : 0.8171          
##          Neg Pred Value : 0.4000          
##              Prevalence : 0.7583          
##          Detection Rate : 0.5958          
##    Detection Prevalence : 0.7292          
##       Balanced Accuracy : 0.6170          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="prediction-and-classification.html#cb205-1" tabindex="-1"></a>b[[<span class="st">&quot;overall&quot;</span>]][[<span class="st">&quot;Accuracy&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] 0.7041667</code></pre>
</div>
<div id="from-one-doppelganger-to-many" class="section level3 hasAnchor" number="19.2.2">
<h3><span class="header-section-number">19.2.2</span> from one doppelganger to many<a href="prediction-and-classification.html#from-one-doppelganger-to-many" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the above code, we used a k-nearest neighbor analysis based on a single ‘neighbor’ (k = 1). Can we improve prediction by considering more than 1 neighbor?</p>
</div>
<div id="the-bayesian-classifier" class="section level3 hasAnchor" number="19.2.3">
<h3><span class="header-section-number">19.2.3</span> the Bayesian classifier<a href="prediction-and-classification.html#the-bayesian-classifier" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lisa is a doctor whose patients often have post-surgical pain. Their suffering is real, but effective pain medications such as OxyContin have a high likelihood of leading to abuse and addiction. She has two bits of information about a patient, his or her age (say that we have this in ten levels, corresponding to decades of age, so that the first level is “under 20” and that the last level is “over 100”), and his or her self-report of pain, also on a 10 point scale.</p>
<p>Assume that Lisa wants to prescribe the medication to all patients who would not abuse it, and not prescribe the medication to anyone who would.</p>
<p>Assume that Lisa knew the entire matrix of conditional probabilities,</p>
<blockquote>
<p>P (addiction | “age &lt; 20” &amp; “pain = 1”) = .34</p>
<p>P (addiction | “age &lt; 20” &amp; “pain = 2”) = .26</p>
<p>… P (addiction | “age &gt; 100” &amp; “pain = 10”) = .09</p>
</blockquote>
<p>In this case she would prescribe the drug for every case where the conditional probability was greater than .5, and never otherwise. This is called the <strong>Bayesian classifier</strong>, and if we have the entire matrix of conditional probabilities we could do no better.</p>
<p>In real world problems, we are typically dealing with many predictors, and we don’t have the full matrix of conditional probabilities. But this two predictor case “sets up” the illustration drawn from <span class="citation">James et al. (<a href="#ref-james2013">2013</a>)</span>.</p>
<blockquote>
<div class="float">
<img src="images/knnTwovaluesfromJames2013.PNG" alt="Figure 19.1: Comparing two values of k. From James et al. (2013)." />
<div class="figcaption">Figure 19.1: Comparing two values of k. From <span class="citation">James et al. (<a href="#ref-james2013">2013</a>)</span>.</div>
</div>
</blockquote>
<p>In the figure above, assume that the horizontal and vertical axes correspond to scores on the two predictors (age and pain). The orange and blue colored dots correspond to cases of abuse and non-abuse in the training data. The dashed line is the Bayesian classifier. The solid line is the k-nn decision boundary, which distinguishes the regions in which we will predict abuse and non abuse in the test data. We see that when k is small (a single neighbor), prediction is flexible, non-linear, and that as k increases, the boundary differentiating the decision to prescribe and not prescribe becomes more nearly linear.</p>
<p>But what value of k is optimal?</p>
</div>
<div id="back-to-the-affairs-data" class="section level3 hasAnchor" number="19.2.4">
<h3><span class="header-section-number">19.2.4</span> Back to the affairs data<a href="prediction-and-classification.html#back-to-the-affairs-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test a range of values, we can first set up our knn analysis as a function (compare this code with the code in the prior section).</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="prediction-and-classification.html#cb207-1" tabindex="-1"></a>trainPredictors <span class="ot">&lt;-</span> trainFair <span class="sc">%&gt;%</span></span>
<span id="cb207-2"><a href="prediction-and-classification.html#cb207-2" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb207-3"><a href="prediction-and-classification.html#cb207-3" tabindex="-1"></a>testPredictors <span class="ot">&lt;-</span> testFair <span class="sc">%&gt;%</span></span>
<span id="cb207-4"><a href="prediction-and-classification.html#cb207-4" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb207-5"><a href="prediction-and-classification.html#cb207-5" tabindex="-1"></a>knnFairdata <span class="ot">&lt;-</span> <span class="cf">function</span> (k) {</span>
<span id="cb207-6"><a href="prediction-and-classification.html#cb207-6" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb207-7"><a href="prediction-and-classification.html#cb207-7" tabindex="-1"></a>    knnAffair <span class="ot">&lt;-</span> <span class="fu">knn</span>(trainPredictors, <span class="co"># training data</span></span>
<span id="cb207-8"><a href="prediction-and-classification.html#cb207-8" tabindex="-1"></a>                 testPredictors, <span class="co"># test data</span></span>
<span id="cb207-9"><a href="prediction-and-classification.html#cb207-9" tabindex="-1"></a>                 trainFair<span class="sc">$</span>affairYN, <span class="co"># class</span></span>
<span id="cb207-10"><a href="prediction-and-classification.html#cb207-10" tabindex="-1"></a>                 k <span class="co"># number of neighbors</span></span>
<span id="cb207-11"><a href="prediction-and-classification.html#cb207-11" tabindex="-1"></a>                 )</span>
<span id="cb207-12"><a href="prediction-and-classification.html#cb207-12" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(knnAffair, testFair<span class="sc">$</span>affairYN)</span>
<span id="cb207-13"><a href="prediction-and-classification.html#cb207-13" tabindex="-1"></a>    b[[<span class="st">&quot;overall&quot;</span>]][[<span class="st">&quot;Accuracy&quot;</span>]]</span>
<span id="cb207-14"><a href="prediction-and-classification.html#cb207-14" tabindex="-1"></a>}</span></code></pre></div>
<p>We run the function on k = 1 and k = 2 to test it:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="prediction-and-classification.html#cb208-1" tabindex="-1"></a><span class="fu">knnFairdata</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.7041667</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="prediction-and-classification.html#cb210-1" tabindex="-1"></a><span class="fu">knnFairdata</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.6958333</code></pre>
<p>Now we can apply it to as many as 100 values of k, using the purrr::map command:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="prediction-and-classification.html#cb212-1" tabindex="-1"></a>kAccuracy <span class="ot">&lt;-</span> (<span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,knnFairdata)) <span class="sc">%&gt;%</span> <span class="co"># map the knnFunction onto numbers 1-100</span></span>
<span id="cb212-2"><a href="prediction-and-classification.html#cb212-2" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span>  <span class="co"># then a tibble so we can do a quick plot</span></span>
<span id="cb212-3"><a href="prediction-and-classification.html#cb212-3" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Accuracy =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb212-4"><a href="prediction-and-classification.html#cb212-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">k =</span> <span class="fu">seq_along</span>(Accuracy))</span></code></pre></div>
<p>We can graph this, using the syntax from the beginning of the class:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="prediction-and-classification.html#cb213-1" tabindex="-1"></a>kAccuracy <span class="sc">%&gt;%</span> </span>
<span id="cb213-2"><a href="prediction-and-classification.html#cb213-2" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(k, Accuracy)) <span class="sc">+</span><span class="co">#%&gt;% </span></span>
<span id="cb213-3"><a href="prediction-and-classification.html#cb213-3" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb213-4"><a href="prediction-and-classification.html#cb213-4" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Overall accuracy for varying levels of k&quot;</span>)</span></code></pre></div>
<p><img src="DataSciLibArts_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="prediction-and-classification.html#cb214-1" tabindex="-1"></a><span class="co"># This pulls out the maximum accuracy, and the value of k for which it occurs:</span></span>
<span id="cb214-2"><a href="prediction-and-classification.html#cb214-2" tabindex="-1"></a>(ka <span class="ot">&lt;-</span> <span class="fu">which.max</span>(kAccuracy<span class="sc">$</span>Accuracy))</span></code></pre></div>
<pre><code>## [1] 33</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="prediction-and-classification.html#cb216-1" tabindex="-1"></a>(kb <span class="ot">&lt;-</span> <span class="fu">max</span>(kAccuracy<span class="sc">$</span>Accuracy))</span></code></pre></div>
<pre><code>## [1] 0.7583333</code></pre>
</div>
<div id="avoiding-capitalization-on-chance-again" class="section level3 hasAnchor" number="19.2.5">
<h3><span class="header-section-number">19.2.5</span> avoiding capitalization on chance (again)<a href="prediction-and-classification.html#avoiding-capitalization-on-chance-again" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In these data, with this split of training and test (and this initial seed) the maximum predictability occurs at k = 33, with an overall accuracy of 0.7583333.</p>
<p>Would this hold if we used a different random split? Remember, here, we have tested not one model, but 100 of them, then chosen the best one. The peak in the curve at 33 may well be due to chance characteristics of the test data.</p>
<p>We could address this empirically using one of several techniques. One approach is to have a third independent sample on which to test the accuracy of prediction at k = 33. This would require the separate validation sample that was introduced in the last chapter.</p>
<p>In the following block, I resplit the Fair data, using proportions of 60%, 30%, 10%. These values are likely not optimal given the (relatively small) size of the Fair data, but will work to illustrate the approach:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="prediction-and-classification.html#cb218-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb218-2"><a href="prediction-and-classification.html#cb218-2" tabindex="-1"></a>threeWaySplit <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="fu">nrow</span>(Fair),</span>
<span id="cb218-3"><a href="prediction-and-classification.html#cb218-3" tabindex="-1"></a>                        <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>),</span>
<span id="cb218-4"><a href="prediction-and-classification.html#cb218-4" tabindex="-1"></a>                        <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb218-5"><a href="prediction-and-classification.html#cb218-5" tabindex="-1"></a>trainFair2 <span class="ot">&lt;-</span> Fair[threeWaySplit <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb218-6"><a href="prediction-and-classification.html#cb218-6" tabindex="-1"></a>testFair2 <span class="ot">&lt;-</span> Fair[threeWaySplit <span class="sc">==</span> <span class="dv">2</span>,]</span>
<span id="cb218-7"><a href="prediction-and-classification.html#cb218-7" tabindex="-1"></a>validFair2 <span class="ot">&lt;-</span> Fair[threeWaySplit <span class="sc">==</span> <span class="dv">3</span>,]</span></code></pre></div>
<p>I tweak my function here to use the new data, then run it 100 times as before.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="prediction-and-classification.html#cb219-1" tabindex="-1"></a>trainPredictors <span class="ot">&lt;-</span> trainFair2 <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="prediction-and-classification.html#cb219-2" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb219-3"><a href="prediction-and-classification.html#cb219-3" tabindex="-1"></a>testPredictors <span class="ot">&lt;-</span> testFair2 <span class="sc">%&gt;%</span></span>
<span id="cb219-4"><a href="prediction-and-classification.html#cb219-4" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>affairYN)</span>
<span id="cb219-5"><a href="prediction-and-classification.html#cb219-5" tabindex="-1"></a>knnFairdata2 <span class="ot">&lt;-</span> <span class="cf">function</span> (k) {</span>
<span id="cb219-6"><a href="prediction-and-classification.html#cb219-6" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">33458</span>)</span>
<span id="cb219-7"><a href="prediction-and-classification.html#cb219-7" tabindex="-1"></a>    knnAffair <span class="ot">&lt;-</span> <span class="fu">knn</span>(trainPredictors, <span class="co"># training data</span></span>
<span id="cb219-8"><a href="prediction-and-classification.html#cb219-8" tabindex="-1"></a>             testPredictors, <span class="co"># test data</span></span>
<span id="cb219-9"><a href="prediction-and-classification.html#cb219-9" tabindex="-1"></a>             trainFair2<span class="sc">$</span>affairYN, <span class="co"># class</span></span>
<span id="cb219-10"><a href="prediction-and-classification.html#cb219-10" tabindex="-1"></a>             k <span class="co"># number of neighbors</span></span>
<span id="cb219-11"><a href="prediction-and-classification.html#cb219-11" tabindex="-1"></a>             )</span>
<span id="cb219-12"><a href="prediction-and-classification.html#cb219-12" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(knnAffair, testFair2<span class="sc">$</span>affairYN)</span>
<span id="cb219-13"><a href="prediction-and-classification.html#cb219-13" tabindex="-1"></a>    b[[<span class="st">&quot;overall&quot;</span>]][[<span class="st">&quot;Accuracy&quot;</span>]]</span>
<span id="cb219-14"><a href="prediction-and-classification.html#cb219-14" tabindex="-1"></a>}</span>
<span id="cb219-15"><a href="prediction-and-classification.html#cb219-15" tabindex="-1"></a>kAccuracy <span class="ot">&lt;-</span> (<span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,knnFairdata2)) <span class="sc">%&gt;%</span> <span class="co"># map the knnFunction onto numbers 1-100</span></span>
<span id="cb219-16"><a href="prediction-and-classification.html#cb219-16" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span>  <span class="co"># then a tibble so we can do a quick plot</span></span>
<span id="cb219-17"><a href="prediction-and-classification.html#cb219-17" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Accuracy=</span>value) <span class="sc">%&gt;%</span> </span>
<span id="cb219-18"><a href="prediction-and-classification.html#cb219-18" tabindex="-1"></a>    <span class="fu">mutate</span> (<span class="at">k =</span> <span class="fu">seq_along</span>(Accuracy))</span>
<span id="cb219-19"><a href="prediction-and-classification.html#cb219-19" tabindex="-1"></a>(ka2 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(kAccuracy<span class="sc">$</span>Accuracy))</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="prediction-and-classification.html#cb221-1" tabindex="-1"></a>(kb2 <span class="ot">&lt;-</span> <span class="fu">max</span>(kAccuracy<span class="sc">$</span>Accuracy))</span></code></pre></div>
<pre><code>## [1] 0.7802198</code></pre>
<p>So here, on the (contaminated) test data, the maximum predictability occurs at k = 15, with an overall accuracy of 0.7802198. We apply this back to the validation data by pulling the knn code out of the function, and running it just once against the validation data:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="prediction-and-classification.html#cb223-1" tabindex="-1"></a>knnAffair <span class="ot">&lt;-</span> <span class="fu">knn</span>(trainFair2[,<span class="sc">-</span><span class="dv">7</span>], <span class="co"># training data</span></span>
<span id="cb223-2"><a href="prediction-and-classification.html#cb223-2" tabindex="-1"></a>             validFair2[,<span class="sc">-</span><span class="dv">7</span>], <span class="co"># VALIDATION data</span></span>
<span id="cb223-3"><a href="prediction-and-classification.html#cb223-3" tabindex="-1"></a>             trainFair2<span class="sc">$</span>affairYN, <span class="co"># class</span></span>
<span id="cb223-4"><a href="prediction-and-classification.html#cb223-4" tabindex="-1"></a>             ka2 <span class="co"># number of neighbors</span></span>
<span id="cb223-5"><a href="prediction-and-classification.html#cb223-5" tabindex="-1"></a>             )</span>
<span id="cb223-6"><a href="prediction-and-classification.html#cb223-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(knnAffair, validFair2<span class="sc">$</span>affairYN)</span>
<span id="cb223-7"><a href="prediction-and-classification.html#cb223-7" tabindex="-1"></a>(kb3 <span class="ot">&lt;-</span> b[[<span class="st">&quot;overall&quot;</span>]][[<span class="st">&quot;Accuracy&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 0.703125</code></pre>
<p>The overall predictability using the k-nearest neighbor analysis on the clean validation data, is now 0.703125.</p>
<p>You might note that in our two splits of the Fair data - the two-way split of 60% Training and 40% Test, and the three-way split of 60% Training, 30% Test, 10% Validation, we got two different solutions to the question of the ‘optimal k’ (i.e., 33 and 15). With larger sample sizes, these values would be more stable.</p>
</div>
<div id="the-multinomial-case" class="section level3 hasAnchor" number="19.2.6">
<h3><span class="header-section-number">19.2.6</span> the multinomial case<a href="prediction-and-classification.html#the-multinomial-case" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A final comment on the k-nearest neighbors approach: You can extend this to classification problems in which we are predicting not just a dichotomous outcome, but a multinomial one - such as a personality type or college concentration.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-james2013" class="csl-entry">
James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2013. <em>An <span>Introduction</span> to <span>Statistical Learning</span></em>. Vol. 103. Springer <span>Texts</span> in <span>Statistics</span>. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-1-4614-7138-7">https://doi.org/10.1007/978-1-4614-7138-7</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross-validation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-chihuahuas-vs-muffins-and-other-distinctions-and-ideas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
