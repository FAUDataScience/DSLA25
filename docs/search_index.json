[["finding-exploring-and-cleaning-data.html", "9 finding, exploring, and cleaning data 9.1 florida educational data", " 9 finding, exploring, and cleaning data Data science, oddly enough, begins not with R… but with data. There is no shortage of datasets available to analyze, and each can give rise to a host of interesting analyses and insights. What do you want to study? Let’s begin by looking at schools 9.1 florida educational data Florida, like many states, makes data on school quality publicly available. Schools are assessed, in part, on student performance (scores on comprehensive tests in fields such as English Language Arts). Schools are also assessed on measures such as whether this performance has increased across years, the percent of students who graduate in four years, and the percentage of students who pass Advanced Placement and related exams. You can learn more about these measures at https://www.fldoe.org/core/fileparse.php/18534/urlt/SchoolGradesOverview24.pdf). The data itself are available in an Excel spreadsheet. Here’s a screenshot of the first few columns and rows of the file. It’s apparent that the file looks a little messy. As we saw in a prior chapter, we would like the first row of the dataset to include the variable (column) names: here, there are three rows of header prior to this. Further, many of the variable names include spaces, minus signs, and the like. We will first download the data from the web (at this writing, you can find it at https://www.fldoe.org/file/18534/SchoolGrades24.xlsx). We will store it on our disk in a subdirectory of our project folder called ‘data.’ Slash: Windows or Mac? 9.1.1 A digression: Slash, Windows and the world. Once we download the data, we need to tell R where to find it. If we are working with an Rproject, we might keep everything - code, data, and output - in the same directory. But we often need or want to store data in a separate place, in which case you will need to specify a file path, which will include one or more slashes (and not the Guns N’ Roses guitarist kind). In most of the computing world, including Macs, filepaths are delineated by forward slashes (“/”). On a Windows machine, they instead include backwards slashes (“\\”). To further complicate matters, the backwards slash has a special significance as an ‘escape’ character - this means, as we will see in the chapter on text analysis, that it tells the system to interpret the following character literally (for example, a comma is read as a comma) rather than symbolically (where a comma might be read as a separator between two objects). In any operating system, we can locate files using relative paths (starting in your project directory) or absolute ones (starting in your computer’s root directory). Relative paths generally work better, as you can use the code on multiple machines. But if you can’t find your datafile, try the absolute path as a kludge. 9.1.2 Getting the data from our machine into R Ones we have specified the datapath, we can use the read_excel command, which is in the readxl library, which is part of the peripheral tidyverse (so you do not need to first install it on your computer). We’ll tell R to skip the first three lines of text. We’ll continue the pipe with a simple command from the janitor package - which you will need to load on to your machine. That command gets rid of spaces in variable names and replaces them with camelCase or, the default, snake_case. (To see why you want to do this try omitting this line from your code). # relative path with backward slashes replaced by forward ones datadir &lt;- &quot;data/&quot; # this is a relative path # absolute path with backward slashes made literal with escapes # datadir &lt;- &quot;C:\\\\Users\\\\me\\\\OneDrive\\\\GitRepos\\\\DSLA25\\\\data\\\\&quot; FloridaSchools &lt;- read_excel( # here, we could also just do # &quot;data/SchoolGrades24.xlsx&quot;), paste0(datadir, &quot;SchoolGrades24.xlsx&quot;), skip = 3) |&gt; clean_names() 9.1.3 let’s look just at high schools There are a few ways that we could reduce this to just High Schools - one is to include only schools which report a graduation rate that is not a missing value. We’ll do that to reduce the number of rows in the data, and we’ll reduce the columns to a handful of measures of interest. FloridaHighSchools &lt;- FloridaSchools |&gt; filter(str_detect(school_name, &quot;HIGH SCHOOL&quot;)) |&gt; mutate(school_name = str_replace(school_name, &quot;JUNIOR/SENIOR HIGH SCHOOL&quot;,&quot;&quot;)) |&gt; mutate(school_name = str_replace(school_name, &quot;MIDDLE/HIGH SCHOOL&quot;,&quot;&quot;)) |&gt; mutate(school_name = str_replace(school_name, &quot;SENIOR HIGH SCHOOL&quot;,&quot;&quot;)) |&gt; mutate(school_name = str_replace(school_name, &quot;HIGH SCHOOL&quot;,&quot;&quot;)) |&gt; # drop_na(&#39;graduation_rate_2022_23&#39;) |&gt; select (district_number, district_name, school_number, school_name, english_language_arts_achievement, mathematics_achievement, science_achievement, social_studies_achievement, graduation_rate_2022_23, grade_2024, percent_of_economically_disadvantaged_students) head(FloridaHighSchools) ## # A tibble: 6 × 11 ## district_number district_name school_number school_name english_language_art…¹ ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 01 ALACHUA 0151 &quot;GAINESVIL… 54 ## 2 01 ALACHUA 0201 &quot;HAWTHORNE… 32 ## 3 01 ALACHUA 0261 &quot;NEWBERRY &quot; 53 ## 4 01 ALACHUA 0271 &quot;SANTA FE &quot; 56 ## 5 01 ALACHUA 0411 &quot;PROFESSIO… 64 ## 6 01 ALACHUA 0421 &quot;EASTSIDE &quot; 47 ## # ℹ abbreviated name: ¹​english_language_arts_achievement ## # ℹ 6 more variables: mathematics_achievement &lt;dbl&gt;, science_achievement &lt;dbl&gt;, ## # social_studies_achievement &lt;dbl&gt;, graduation_rate_2022_23 &lt;dbl&gt;, ## # grade_2024 &lt;chr&gt;, percent_of_economically_disadvantaged_students &lt;dbl&gt; 9.1.4 can we compute district (county) means? Here, we reduce the set of high schools to one line per district, with scores the simple means of the schools in the district. FloridaHighSchoolsbyDistict &lt;- FloridaHighSchools |&gt; # select(-grade, -school_name) |&gt; group_by(district_name) |&gt; summarise_if(is.numeric, mean) FloridaHighSchoolsbyDistict |&gt; select(graduation_rate_2022_23, percent_of_economically_disadvantaged_students) |&gt; correlate() ## Correlation computed with ## • Method: &#39;pearson&#39; ## • Missing treated using: &#39;pairwise.complete.obs&#39; ## # A tibble: 2 × 3 ## term graduation_rate_2022…¹ percent_of_economica…² ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 graduation_rate_2022_23 NA -0.464 ## 2 percent_of_economically_disadva… -0.464 NA ## # ℹ abbreviated names: ¹​graduation_rate_2022_23, ## # ²​percent_of_economically_disadvantaged_students Is there a relationship between graduation rate and economic disadvantage? Which districts score at the top and bottom of these two indices? On the basis of our previous discussions in the class, what would we expect them to have in common? 9.1.5 so what should we do now? There are measures of school size in Football league data (https://fhsaa.com/news/2023/12/21/football-classifications-available-for-2024-25-2025-26.aspx). The names for schools there are formatted differently, however. We will use these classes to estimate enrollments and try to merge these with the data we have on school ratings. EnrollmentsFromFHSAA &lt;- read_excel( paste0(datadir, &quot;Football_2024_26.xlsx&quot;), skip = 1) |&gt; clean_names() |&gt; mutate(school_place = str_split(school_name,&#39;\\\\(&#39;, simplify = T)[,2]) |&gt; mutate(school_place = str_replace(school_place, &quot;\\\\)&quot;, &quot;&quot;)) |&gt; mutate(school_name = str_split(school_name,&#39;\\\\(&#39;, simplify = T)[,1]) |&gt; mutate (est_Enrollment = case_when( class == &quot;1R&quot; ~ mean(111,558), class == &quot;1A&quot; ~ mean(61,643), class == &quot;2A&quot; ~ mean(644,1166), class == &quot;3A&quot; ~ mean(1167,1542), class == &quot;4A&quot; ~ mean(1543,1822), class == &quot;5A&quot; ~ mean(1823,2135), class == &quot;6A&quot; ~ mean(2136,2512), class == &quot;7A&quot; ~ mean(2512,4627))) |&gt; mutate(school_name = toupper(school_name)) The enrollment data are now in the EnrollmentsFromFHSAA dataset. We would like to merge these with the FloridaHighSchools data, using the school_name variable as the key. FloridaHighSchools2 &lt;- FloridaHighSchools |&gt; left_join(EnrollmentsFromFHSAA, by = &quot;school_name&quot;) ## Warning in left_join(FloridaHighSchools, EnrollmentsFromFHSAA, by = &quot;school_name&quot;): Detected an unexpected many-to-many relationship between `x` and `y`. ## ℹ Row 38 of `x` matches multiple rows in `y`. ## ℹ Row 187 of `y` matches multiple rows in `x`. ## ℹ If a many-to-many relationship is expected, set `relationship = ## &quot;many-to-many&quot;` to silence this warning. But when we do this, we get an error message. In each of the two datasets, there are duplicate names. We can see this by looking at the output of the following commands: (SchoolsWithSameNamesInFHS &lt;- FloridaHighSchools |&gt; group_by(school_name) |&gt; filter(n() &gt; 1) |&gt; select (school_name, district_name) |&gt; arrange(school_name)) ## # A tibble: 12 × 2 ## # Groups: school_name [6] ## school_name district_name ## &lt;chr&gt; &lt;chr&gt; ## 1 &quot;ATLANTIC &quot; PALM BEACH ## 2 &quot;ATLANTIC &quot; VOLUSIA ## 3 &quot;FLORIDA SOUTHWESTERN COLLEGIATE &quot; CHARLOTTE ## 4 &quot;FLORIDA SOUTHWESTERN COLLEGIATE &quot; LEE ## 5 &quot;GATEWAY &quot; LEE ## 6 &quot;GATEWAY &quot; OSCEOLA ## 7 &quot;NORTHEAST &quot; BROWARD ## 8 &quot;NORTHEAST &quot; PINELLAS ## 9 &quot;RIVERVIEW &quot; HILLSBOROUGH ## 10 &quot;RIVERVIEW &quot; SARASOTA ## 11 &quot;SEMINOLE &quot; PINELLAS ## 12 &quot;SEMINOLE &quot; SEMINOLE (SchoolsWithSameNamesInEnrollments &lt;- EnrollmentsFromFHSAA |&gt; group_by(school_name) |&gt; filter(n() &gt; 1) |&gt; select (school_name, school_place)) ## # A tibble: 26 × 2 ## # Groups: school_name [13] ## school_name school_place ## &lt;chr&gt; &lt;chr&gt; ## 1 &quot;AMERICAN HERITAGE &quot; Delray Beach ## 2 &quot;AMERICAN HERITAGE &quot; Plantation ## 3 &quot;ATLANTIC &quot; Delray Beach ## 4 &quot;ATLANTIC &quot; Port Orange ## 5 &quot;CENTRAL &quot; Brooksville ## 6 &quot;CENTRAL &quot; Milton ## 7 &quot;CYPRESS CREEK &quot; Orlando ## 8 &quot;CYPRESS CREEK &quot; Wesley Chapel ## 9 &quot;FREEDOM &quot; Orlando ## 10 &quot;FREEDOM &quot; Tampa ## # ℹ 16 more rows There are 12 schools (6 pairs) in our FloridaHighSchools data, and 26 schools (13 pairs) in the EnrollmentsFromFHSAA data. We will set these aside and merge the remaining data. that have the same name. We can see this by looking at the output of the following command: (SchoolsWithUniqueNamesInFHS &lt;- FloridaHighSchools |&gt; group_by(school_name) |&gt; filter(n() == 1)) ## # A tibble: 439 × 11 ## # Groups: school_name [439] ## district_number district_name school_number school_name ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 01 ALACHUA 0151 &quot;GAINESVILLE &quot; ## 2 01 ALACHUA 0201 &quot;HAWTHORNE &quot; ## 3 01 ALACHUA 0261 &quot;NEWBERRY &quot; ## 4 01 ALACHUA 0271 &quot;SANTA FE &quot; ## 5 01 ALACHUA 0411 &quot;PROFESSIONAL ACADEMY MAGNET AT … ## 6 01 ALACHUA 0421 &quot;EASTSIDE &quot; ## 7 01 ALACHUA 0431 &quot;F. W. BUCHHOLZ &quot; ## 8 02 BAKER 0012 &quot;BAKER COUNTY &quot; ## 9 03 BAY 0061 &quot;BAY &quot; ## 10 03 BAY 0341 &quot;RUTHERFORD &quot; ## # ℹ 429 more rows ## # ℹ 7 more variables: english_language_arts_achievement &lt;dbl&gt;, ## # mathematics_achievement &lt;dbl&gt;, science_achievement &lt;dbl&gt;, ## # social_studies_achievement &lt;dbl&gt;, graduation_rate_2022_23 &lt;dbl&gt;, ## # grade_2024 &lt;chr&gt;, percent_of_economically_disadvantaged_students &lt;dbl&gt; (SchoolsWithUniqueNamesInEnrollments &lt;- EnrollmentsFromFHSAA |&gt; group_by(school_name) |&gt; filter(n() == 1)) ## # A tibble: 520 × 6 ## # Groups: school_name [520] ## school_name class region district school_place est_Enrollment ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 &quot;ALL SAINTS&#39; &quot; Independe… Indep… Indepen… &quot;Winter Hav… NA ## 2 &quot;ALONSO &quot; 7A 2 7 &quot;Tampa&quot; 2512 ## 3 &quot;AMERICAN &quot; 4A 4 16 &quot;Hialeah&quot; 1543 ## 4 &quot;ANCLOTE &quot; 3A 3 9 &quot;Holiday&quot; 1167 ## 5 &quot;ANDREW JACKSON &quot; 2A 1 4 &quot;Jacksonvil… 644 ## 6 &quot;APOPKA&quot; 7A 2 5 &quot;&quot; 2512 ## 7 &quot;ARCHBISHOP CARROLL &quot; 1A 4 15 &quot;Miami&quot; 61 ## 8 &quot;ARCHBISHOP MCCARTHY &quot; 4A 4 15 &quot;Southwest … 1543 ## 9 &quot;ARMWOOD &quot; 6A 2 8 &quot;Seffner&quot; 2136 ## 10 &quot;ARNOLD &quot; 4A 1 2 &quot;Panama Cit… 1543 ## # ℹ 510 more rows FloridaHighSchools2 &lt;- SchoolsWithUniqueNamesInFHS |&gt; left_join(SchoolsWithUniqueNamesInEnrollments, by = &quot;school_name&quot;) 9.1.6 so what should we do now? "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
